# --------------------------------------------------------------------
# 90-screenshot.conf â€“ screenshot helpers (region / output only)
# --------------------------------------------------------------------
### variables ---------------------------------------------------------
set $grimshot grimshot
set $ss_dir   $HOME/Screenshots
exec_always --no-startup-id mkdir -p $ss_dir     # make sure the dir exists

# Banner that Waybar shows when Print is hit
set $mode_screenshot "<b>screenshot</b>   [p] region   [o] output   [d] delay   (Shift = upload)"

### pipelines ---------------------------------------------------------
# region (instant)
set $screenshot_region    $grimshot save area   "$ss_dir/$(date +%Y-%m-%d-%H%M%S)_region.png" && notify-send "Screenshot saved" "Region capture"
set $screenshot_region_up $grimshot save area   - | curl -s -F "file=@-;filename=.png" https://x0.at/ | tee >(wl-copy) | xargs -I{} notify-send "Uploaded" "{}"

# output (instant)
set $screenshot_screen    $grimshot save output "$ss_dir/$(date +%Y-%m-%d-%H%M%S)_screen.png" && notify-send "Screenshot saved" "Screen capture"
set $screenshot_screen_up $grimshot save output - | curl -s -F "file=@-;filename=.png" https://x0.at/ | tee >(wl-copy) | xargs -I{} notify-send "Uploaded" "{}"

# region with swappy
set $screenshot_region_edit $grimshot save area - | swappy -f - -o "$ss_dir/$(date +%Y-%m-%d-%H%M%S)_edit.png"

### mode definition ---------------------------------------------------
mode --pango_markup $mode_screenshot {
    bindsym p          mode "default", exec $screenshot_region_edit
    bindsym Shift+p    mode "default", exec $screenshot_region_up
    bindsym o          mode "default", exec $screenshot_screen
    bindsym Shift+o    mode "default", exec $screenshot_screen_up
    bindsym d          mode "default", exec ~/.local/bin/screenshot-delay.sh
    bindsym Escape     mode "default"
}

# Invoke the mode with Print
bindsym Print mode $mode_screenshot
